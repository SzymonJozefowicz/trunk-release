# HTML
# Archive your static HTML project and save it with the build record.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

trigger:
- main

pr: none

variables:
  - name: TAG
    value: $[format('1.0.{0}',variables['Build.BuildId'])]
  - name: RELEASE
    value: "Release $[format('1.0.{0}',variables['Build.BuildId'])]"
pool:
  vmImage: ubuntu-latest

steps:
- script: |
    ls -lah
    cat index.html
    echo $TAG
  displayName: View index file and list folder
- task: GitHubRelease@1
  inputs:
    gitHubConnection: 'szymon-github'
    repositoryName: '$(Build.Repository.Name)'
    action: 'create'
    target: '$(Build.SourceVersion)'
    tagSource: 'userSpecifiedTag'
    tag: '$(TAG)'
    releaseNotesSource: 'inline'
    # releaseNotesInline: 'Release $(Build.SourceVersion)'
    releaseNotesFilePath: 'release.md'
    changeLogCompareToRelease: 'lastFullRelease'
    changeLogType: 'commitBased'

- task: DownloadGitHubRelease@0
  inputs:
    connection: 'szymon-github'
    userRepository: 'szymonjozefowicz/trunk-release'
    defaultVersionType: 'latest'
    downloadPath: '$(System.ArtifactsDirectory)'